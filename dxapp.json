{
  "name": "sambamba_coverage_v2.0",
  "title": "Coverage Analysis using Sambamba v0.6.9",
  "summary": "v2.0 - Coverage analysis using sambamba with Python-based reporting",
  "tags": [
    "coverage"
  ],
  "properties": {
    "github release": "v2.0"
  },
  "dxapi": "1.0.0",
  "access": {
    "network": [
      "*"
    ]
  },
  "inputSpec": [
    {
      "name": "sambamba_bed",
      "label": "sambamba_bed",
      "help": "A sambamba bedfile.",
      "class": "file",
      "patterns": [
        "*.bed"
      ]
    },
    {
      "name": "bamfile",
      "label": "bamfile",
      "help": "bam file.",
      "class": "file",
      "patterns": [
        "*.bam"
      ]
    },
    {
      "name": "bam_index",
      "label": "bamfile_index",
      "help": "bam index.",
      "class": "file",
      "patterns": [
        "*.bai"
      ]
    },
    {
      "name": "merge_overlapping_mate_reads",
      "label": "count overlapping mate reads once",
      "help": "Should overlapping mate reads be counted once? True = counted once. False = counted twice",
      "class": "boolean",
      "default": true
    },
    {
      "name": "exclude_failed_quality_control",
      "label": "Exclude reads which have failed quality_control",
      "help": "Should reads which have failed quality_control be excluded? True = Exclude. False = Include",
      "class": "boolean",
      "default": true
    },
    {
      "name": "exclude_duplicate_reads",
      "label": "Exclude duplicate reads",
      "help": "Should duplicate reads be excluded? True = Exclude. False = Include",
      "class": "boolean",
      "default": true
    },
    {
      "name": "coverage_level",
      "label": "coverage level",
      "help": "The level of coverage to be reported.",
      "class": "string"
    },
    {
      "name": "additional_sambamba_flags",
      "label": "Additional Sambamba flags",
      "help": "Free form text field to send additional flag options to Sambamba",
      "class": "string",
      "default": ""
    },
    {
      "name": "additional_filter_commands",
      "label": "Additional Sambamba filter commands",
      "help": "Free form text field to send additional filter options to Sambamba (text most start ' and ')",
      "class": "string",
      "default": ""
    },
    {
      "name": "min_base_qual",
      "label": "min base quality score (-q)",
      "help": "The minimum base quality score required to be counted.",
      "class": "int",
      "default": 25
    },
    {
      "name": "min_mapping_qual",
      "label": "min mapping quality score",
      "help": "The minimum mapping quality score required to be counted.",
      "class": "int",
      "default": 20
    }
  ],
  "outputSpec": [
    {
      "name": "sambamba_output",
      "label": "Sambamba raw output",
      "help": "Raw BED file output by sambamba containing coverage data for all regions.",
      "class": "array:file"
    },
    {
      "name": "gene_level_report",
      "label": "Gene-level coverage report",
      "help": "Tab-delimited file containing gene-level coverage statistics including mean coverage, completeness percentage, exon count, and total length.",
      "class": "array:file"
    },
    {
      "name": "exon_level_report",
      "label": "Exon-level coverage report",
      "help": "Tab-delimited file containing exon-level coverage data for regions with less than 100% coverage at the specified threshold.",
      "class": "array:file"
    }
  ],
  "runSpec": {
    "execDepends": [
      {
        "name": "python3"
      },
      {
        "name": "python3-pip"
      },
      {
        "name": "jq"
      }
    ],
    "file": "src/code.sh",
    "release": "20.04",
	"version" : "0",
    "interpreter": "bash",
    "distribution": "Ubuntu"
  },
  "ignoreReuse": false,
  "regionalOptions": {
    "aws:us-east-1": {
      "systemRequirements": {
        "main": {
          "instanceType": "mem1_ssd1_v2_x2"
        }
      }
    }
  }
}